require "rake/clean"
require_relative "../helper"

CLEAN << "temp" << "__pycache__"

file "temp" do
  mkdir "temp"
end

namespace :test do
  desc "Test the Python reader"
  task :reader do
    sh "python reader_test.py"
  end

  desc "Test the Python writer"
  task :writer do
    sh "python writer_test.py"
  end

  desc "Test the whole Python library"
  task python: %w[test:reader test:writer] do
  end

  desc "Test the plugins's Ruby engine"
  task :engine do
    ruby "-I../../core/lib -Idist/include/python engine_test.rb"
  end
end

desc "Generate solutions for some fixed problems using this plugin"
task generate: "temp" do
  generate_solutions File.dirname(__FILE__)
end

desc "Try running the solutions that were generated by rake generate"
task run: "temp" do
  try_run_solutions File.dirname(__FILE__)
end
